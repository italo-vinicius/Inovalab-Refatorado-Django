<div class="relatorios-container">
  
  <div class="page-header">
    <div class="container">
      <h1>üìä Relat√≥rios INOVALAB</h1>
      <p>Gere relat√≥rios detalhados e exporte em PDF</p>
    </div>
  </div>

  
  <section class="principal-section" *ngIf="!relatorioSelecionado && publicacoesAtivas.length === 0">
    <div class="container">
      <h2 class="section-title">üìù Publica√ß√µes do Sistema</h2>
      <p class="section-description">Visualize todas as publica√ß√µes ativas do sistema</p>

      
      <div class="acao-publicacoes">
        <button class="btn-publicacoes-ativas"
                (click)="exibirPublicacoesAtivas()"
                [disabled]="carregando">
          <span class="btn-icon">üìù</span>
          <span class="btn-text">Ver Todas as Publica√ß√µes Ativas</span>
          <span class="btn-arrow">‚Üí</span>
        </button>
      </div>
    </div>
  </section>

  
  <section class="publicacoes-ativas-section" *ngIf="publicacoesAtivas.length > 0 && !relatorioSelecionado">
    <div class="container">
      <h2 class="section-title">üìù Publica√ß√µes Ativas ({{ publicacoesAtivas.length }})</h2>

      <div class="publicacoes-grid">
        <div class="publicacao-card" *ngFor="let publicacao of publicacoesAtivas">
          <div class="publicacao-header">
            <h3 class="publicacao-titulo">{{ publicacao.titulo }}</h3>
            <span class="publicacao-status ativo">{{ publicacao.status }}</span>
          </div>

          <div class="publicacao-resumo">
            <p>{{ publicacao.resumo }}</p>
          </div>

          <div class="publicacao-meta">
            <div class="meta-item">
              <span class="meta-label">Autor:</span>
              <span class="meta-value">{{ publicacao.autor || 'N√£o informado' }}</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Criado em:</span>
              <span class="meta-value">{{ formatarData(publicacao.criadoEm) }}</span>
            </div>
          </div>

          <div class="publicacao-stats">
            <div class="stat-item">
              <span class="stat-icon">üëÅÔ∏è</span>
              <span class="stat-value">{{ publicacao.visualizacoes }}</span>
              <span class="stat-label">Visualiza√ß√µes</span>
            </div>
            <div class="stat-item">
              <span class="stat-icon">‚ù§Ô∏è</span>
              <span class="stat-value">{{ publicacao.curtidas }}</span>
              <span class="stat-label">Curtidas</span>
            </div>
          </div>
        </div>
      </div>

      
      <div class="acao-voltar">
        <button class="btn-voltar-resumo" (click)="publicacoesAtivas = []">
          ‚Üê Voltar
        </button>
      </div>
    </div>
  </section>

  
  <section class="selecao-relatorios" *ngIf="!relatorioSelecionado">
    <div class="container">
      <h2 class="section-title">üìã Selecione o Tipo de Relat√≥rio</h2>
      <div class="tipos-grid">
        <div class="tipo-card"
             *ngFor="let tipo of tiposRelatorio"
             (click)="selecionarRelatorio(tipo.id)"
             [style.border-left-color]="tipo.cor">
          <div class="tipo-icon" [style.color]="tipo.cor">{{ tipo.icone }}</div>
          <div class="tipo-content">
            <h3>{{ tipo.nome }}</h3>
            <p>{{ tipo.descricao }}</p>
          </div>
          <div class="tipo-arrow">‚Üí</div>
        </div>
      </div>
    </div>
  </section>

  
  <section class="relatorio-section" *ngIf="relatorioSelecionado">
    <div class="container">
      
      <div class="relatorio-header">
        <div class="header-info">
          <button class="btn-voltar" (click)="limparFiltros()">
            ‚Üê Voltar
          </button>
          <div class="relatorio-titulo">
            <h2>
              <span [style.color]="getTipoRelatorio(relatorioSelecionado)?.cor">
                {{ getTipoRelatorio(relatorioSelecionado)?.icone }}
              </span>
              {{ getTipoRelatorio(relatorioSelecionado)?.nome }}
            </h2>
          </div>
        </div>

        <div class="header-actions">
          <button class="btn-exportar"
                  (click)="exportarPDF()"
                  [disabled]="carregando || (!dadosRelatorio.length && relatorioSelecionado !== 'resumo')">
            <i class="icon">üìÑ</i>
            Exportar PDF
          </button>
        </div>
      </div>

      
      <div class="filtros-container">
        <h3>üîç Filtros</h3>
        <div class="filtros-form">
          <div class="filtro-group">
            <label for="dataInicial">Data Inicial</label>
            <input type="date"
                   id="dataInicial"
                   [(ngModel)]="filtro.dataInicial"
                   class="filtro-input">
          </div>

          <div class="filtro-group">
            <label for="dataFinal">Data Final</label>
            <input type="date"
                   id="dataFinal"
                   [(ngModel)]="filtro.dataFinal"
                   class="filtro-input">
          </div>

          <div class="filtro-actions">
            <button class="btn-aplicar"
                    (click)="aplicarFiltros()"
                    [disabled]="carregando">
              <span *ngIf="!carregando">Gerar Relat√≥rio</span>
              <span *ngIf="carregando">
                <div class="loading-spinner"></div>
                Carregando...
              </span>
            </button>

            <button class="btn-limpar"
                    (click)="limparFiltros()"
                    [disabled]="carregando">
              Limpar
            </button>
          </div>
        </div>
      </div>

      
      <div class="loading-container" *ngIf="carregando">
        <div class="loading-spinner large"></div>
        <p>Gerando relat√≥rio...</p>
      </div>

      
      <div class="empty-state" *ngIf="!carregando && relatorioSelecionado !== 'resumo' && dadosRelatorio.length === 0 && mostrarFiltros">
        <div class="empty-icon">üìã</div>
        <h3>Nenhum dado encontrado</h3>
        <p>Tente ajustar os filtros de data ou verifique se existem dados no per√≠odo selecionado.</p>
      </div>
    </div>
  </section>
</div>
